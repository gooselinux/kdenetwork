diff -up kdenetwork-4.3.4-patched/kget/transfer-plugins/metalink/metalinker.cpp.cve-2010-1000 kdenetwork-4.3.4-patched/kget/transfer-plugins/metalink/metalinker.cpp
--- kdenetwork-4.3.4-patched/kget/transfer-plugins/metalink/metalinker.cpp.cve-2010-1000	2011-04-19 12:26:32.000000000 +0200
+++ kdenetwork-4.3.4-patched/kget/transfer-plugins/metalink/metalinker.cpp	2011-04-19 12:39:24.000000000 +0200
@@ -24,7 +24,13 @@ bool MlinkFileData::isValidNameAttribute
         return false;
     }
 
-    if (fileName.contains(QRegExp("$(\\.\\.?)?/")) || fileName.contains("/../") || fileName.endsWith("/..")) {
+    if (fileName.endsWith('/')) {
+        kError(5001) << "Name attribute of Metalink::File does not contain a file name:" << fileName;
+        return false;
+    }
+
+    const QStringList components = fileName.split('/');
+    if (fileName.startsWith('/') || components.contains("..") || components.contains(".")) {
         kError(5001) << "Name attribute of Metalink::File contains directory traversal directives:" << fileName;
         return false;
     }
